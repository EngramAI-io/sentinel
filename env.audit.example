# ===== FEATURE TOGGLES =====
# Enable/disable individual audit features independently
SENTINEL_FEATURE_LOGGING=true
SENTINEL_FEATURE_STORAGE=true
SENTINEL_FEATURE_SESSIONS=true
SENTINEL_FEATURE_REDACTION=true
SENTINEL_FEATURE_ENCRYPTION=true              # NEW: Field-level encryption
SENTINEL_FEATURE_TAMPER_EVIDENT=true          # NEW: HMAC signing
SENTINEL_FEATURE_ANOMALY=true
SENTINEL_FEATURE_OTLP=true
SENTINEL_FEATURE_SIEM=true                    # NEW: SIEM forwarding
SENTINEL_FEATURE_COMPLIANCE=true

# ===== CRYPTOGRAPHY =====
# HMAC key for log entry integrity (32 bytes = 64 hex characters)
# Generate: openssl rand -hex 32
AUDIT_HMAC_KEY=

# AES-256 encryption key for field-level encryption (32 bytes = 64 hex characters)
# Generate: openssl rand -hex 32
AUDIT_ENCRYPTION_KEY=

# Comma-separated list of field names to encrypt
AUDIT_ENCRYPT_FIELDS=password,api_key,token,db_url,secret,credential

# ===== STORAGE =====
# Directory for audit log files
AUDIT_LOG_DIR=./logs/audit

# Log level: DEBUG, INFO, WARN, ERROR, CRITICAL
AUDIT_LOG_LEVEL=INFO

# Retention period in days
AUDIT_LOG_RETENTION_DAYS=365

# Maximum file size before rotation (bytes)
AUDIT_LOG_MAX_FILE_SIZE=104857600

# Enable WORM (Write-Once-Read-Many) - makes files read-only after write
AUDIT_WRITE_ONCE=true

# AWS S3 Object Lock for cloud storage (requires S3 backend)
AUDIT_S3_OBJECT_LOCK=false

# ===== SIEM INTEGRATION =====
# SIEM type: splunk, elk, sentinel, chronicle
SIEM_TYPE=splunk

# SIEM endpoint URL
SIEM_ENDPOINT=https://your-splunk-instance.com:8088

# SIEM authentication token
SIEM_TOKEN=your-api-token-here

# Batch size for SIEM forwarding
SIEM_BATCH_SIZE=100

# ===== PRIVACY & PII =====
# Enable PII tokenization (replaces PII with tokens)
AUDIT_TOKENIZE_PII=true

# Mask email addresses in logs
AUDIT_MASK_EMAILS=true

# Mask phone numbers in logs
AUDIT_MASK_PHONES=true

# Redaction mode: anonymize, mask, tokenize
REDACTION_MODE=anonymize

# ===== OPENTELEMETRY =====
# OTLP endpoint for trace export
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318/v1/traces

# OTLP headers (comma-separated key=value pairs)
OTEL_EXPORTER_OTLP_HEADERS=

# Sampling rate (0.0 to 1.0)
OTEL_SAMPLING_RATE=1.0

# ===== SESSIONS =====
# User ID for audit context
SENTINEL_USER_ID=

# Session timeout in hours
AUDIT_SESSION_TIMEOUT_HOURS=24

# ===== COMPLIANCE =====
# Compliance framework: SOC2, HIPAA, GDPR, PCI-DSS
COMPLIANCE_FRAMEWORK=SOC2

# ===== RUST ENGINE =====
# Use Rust crypto engine for high-performance operations
USE_RUST_ENGINE=false

# ===== ANOMALY DETECTION =====
# Error rate threshold (percentage)
RULE_ERROR_RATE_THRESHOLD=50

# Authentication failure limit before alert
RULE_AUTH_FAILURES=3

# Rate limit (requests per time window)
RULE_RATE_LIMIT=100
